<p>When I first wrote the &#8220;Textarea maxlength with jQuery&#8221; plugin last year I had no idea how popular it would be - over 70% of the traffic to my site since then has been people reading that one post.</p>

<p>The problem is, the code there is basically an ugly hack - you copy and paste and you&#8217;re done. But if you need to implement the same functionality across a site with slight differences to the functionality, you&#8217;d end up with a lot of copy and paste garbage. So what with it being time for some spring cleaning I thought I&#8217;d begin by refactoring the original code into a jquery plugin:</p>
<!-- more -->
<pre><code>jQuery.fn.limitMaxlength = function(options){

    var settings = jQuery.extend({
        attribute: &quot;maxlength&quot;,
        onLimit: function(){},
        onEdit: function(){}
    }, options);

    // Event handler to limit the textarea
    var onEdit = function(){
        var textarea = jQuery(this);
        var maxlength = parseInt(textarea.attr(settings.attribute));

        if(textarea.val().length &gt; maxlength){
            textarea.val(textarea.val().substr(0, maxlength));

            // Call the onlimit handler within the scope of the textarea
            jQuery.proxy(settings.onLimit, this)();
        }

        // Call the onEdit handler within the scope of the textarea
        jQuery.proxy(settings.onEdit, this)(maxlength - textarea.val().length);
    }

    this.each(onEdit);

    return this.keyup(onEdit)
                .keydown(onEdit)
                .focus(onEdit)
                .live(&#39;input paste&#39;, onEdit);
}</code></pre>

<p>And here&#8217;s an example of it in use, limiting all textareas in the document and updating a p element with the id of charsRemaining with&#8230; the number of characters remaining. It also sets the textarea bg color to red when the user tries to exceed the maxlength.</p>

<pre><code>$(document).ready(function(){

    var onEditCallback = function(remaining){
        $(this).siblings(&#39;.charsRemaining&#39;).text(&quot;Characters remaining: &quot; + remaining);

        if(remaining &gt; 0){
            $(this).css(&#39;background-color&#39;, &#39;white&#39;);
        }
    }

    var onLimitCallback = function(){
        $(this).css(&#39;background-color&#39;, &#39;red&#39;);
    }

    $(&#39;textarea[maxlength]&#39;).limitMaxlength({
        onEdit: onEditCallback,
        onLimit: onLimitCallback
    });
});</code></pre>

<p>And here&#8217;s a <a href='http://jsbin.com/ufuji3/9'>jsbin paste with a quick demo</a>.</p>

<p>Although there is a lot more code in this version it&#8217;s a lot more flexible as it allows you to decide how to inform the user of how many characters there&#8217;re remaining. It also means that it&#8217;ll take any characters already in the textbox into account when the document loads.</p>

<p><strong>Update 2010/04/09:</strong> Fixed a few bugs &amp; typos</p>

<p><strong>Update 2010/08/01:</strong> Removed problematic comma &amp; added live(&#8216;input paste&#8217;) - thanks Surya and Len!</p>